# Antigravity 工作流程說明

這份文件說明如何設定 Antigravity 的工作流程(Workflow)。

詳細可以參考官方文件：[Rules / Workflows](https://antigravity.google/docs/rules-workflows)

## 什麼是「工作流」 (Workflows)？

在 Antigravity 的環境中，工作流就是一份「**標準作業程序 (SOP)**」。它是一份放在 .agent/workflows/ 目錄下的 Markdown 檔案，用來告訴 AI：「當我們要執行某個特定任務時，請按照步驟 A -> B -> C 來做。」

優點：確保複雜的任務（如：部署、代碼審查、制定計畫）每次都能以相同的品質與流程完成，減少遺漏步驟的風險。

## 觸發方式

1. **對應檔名**：在 `.agent/workflows/` 資料夾中的每一個 Markdown 檔案，都會自動變成一個指令。
    - 如果有一個檔案叫 `planning.md`，指令就是 `/planning`。
    - 如果有一個檔案叫 `code-review.md`，指令就是 `/code-review`。
2. **觸發執行**：在對話框輸入 `/` 時，系統會列出可用的指令。一旦選擇或輸入完整指令並送出，Antigravity 就會立刻讀取該檔案的內容，並按照裡面的步驟開始執行。

## 工作流 (Workflow) vs. 規則 (Rule)

這兩者通常會搭配使用，共同構建 AI 的行為邏輯。

| 特性         | 工作流 (Workflow)                               | 規則 (Rule)                              |
| :----------- | :---------------------------------------------- | :--------------------------------------- |
| **類比**     | **操作手冊 (SOP)**                              | **法律/習慣 (Policy)**                   |
| **觸發方式** | **主動式**：需由使用者輸入指令 (如 `/planning`) | **被動式**：隨時掛載於腦海，感應情境觸發 |
| **作用時間** | **暫時性**：僅在執行該工作流時生效              | **持續性**：對話過程全程守護             |
| **主要功能** | 定義任務的具體執行步驟                          | 定義行為準則、代碼規範、同步邏輯         |

**為什麼雙箭齊發？**

- **工作流負責「引導」**：確保複雜任務（如開發計畫）能按部就班完成，並在對的時間執行對的工具動作。
- **規則負責「守護」**：確保 AI 無論在什麼情境下（即使沒用指令），產出的品質、格式都能符合專案規範，並負責長期的內容同步與維護。

## 示範

`planning.md`

```markdown
1. **模式確認**：檢查目前是否處於 "Planning" 模式。
   - 如果不是，請親切地提示使用者：「建議將模式切換至 **Planning** 模式以獲得最佳的架構規劃體驗。」
   - 確認模式後，繼續執行後續步驟。
2. 與使用者討論當前任務的需求與目標。
3. 分析技術架構，解決可能的疑點。
4. **建立計畫**：撰寫詳細的實作計畫（Implementation Plan）。
5. **自動存檔**：
   - 使用 `write_to_file` 工具，將計畫內容另存為 Markdown 檔案。
   - 存檔路徑：`Shared\Plans\{任務名稱}_{日期}.md`。
   - 確保檔案包含：任務目標、技術選擇、具體步驟。
6. 在對話中提供存檔路徑的連結，方便使用者點擊查看。
```

`planning-sync.md`

```markdown
# Planning Synchronization Rules

為了確保專案內的開發計畫始終保持最新，請遵循以下規則：

1. **模式守則**：執行此規劃流程時，應引導使用者使用 **Planning** 模式。
2. **初始存檔**：每當透過 `/planning` 工作流產生新的「實作計畫 (Implementation Plan)」時，必須同步寫入一份 Markdown 檔案至 `Shared/Plans/` 目錄。
3. **自動更新**：
   - 當使用者在對話中對已存在的計畫提出修改建議，且你更新了內部的計畫 Artifact 時。
   - 你必須**主動**同步更新對應在 `Shared/Plans/` 目錄下的 Markdown 檔案。
4. **檔案格式**：
   - 檔名規範：`{任務名稱簡稱}_{日期}.md`。
   - 檔案開頭必須包含 `# Implementation Plan: {任務名稱}`。
5. **透明性**：每次同步更新後，請在對話中告知使用者：「已同步更新實作計畫至 {檔案路徑}」。
```
