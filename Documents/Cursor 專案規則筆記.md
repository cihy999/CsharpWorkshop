# 專案規則

[官方文件](https://cursor.com/zh-Hant/docs/context/rules)

專案規則是 Cursor 提供的一種「結構化指令」機制，讓 AI Agent (Chat) 與編輯器 (Inline Edit) 能夠持續遵循專案專屬的規範。

## 基本結構

專案規則通常以 .mdc 檔案形式儲存在專案根目錄的 .cursor/rules/ 資料夾下。

每個檔案包含兩個部分：

1. Frontmatter (元數據設定)：位於檔案最上方，由 --- 包圍，用來控制規則的啟動時機。
   - description: 描述這條規則的用途（這對 AI 判斷「何時該套用」非常重要）。
   - globs: 適用範圍。例如 ["**/*.cs"] 代表所有 C# 檔案。
   - alwaysApply: 是否一律套用。若設為 true，只要符合 glob 模式，AI 就會主動讀取此規則。
2. Content (規則本文)：使用 Markdown 語法撰寫

## 規則套用的類型（Rule Types）

| UI 顯示類型                 | 檔案中的 Frontmatter 關鍵設定                  | 實際的行為 (會有什麼變化？)                                   |
| :-------------------------- | :--------------------------------------------- | :------------------------------------------------------------ |
| **Always Apply**            | `alwaysApply: true`                            | **最強制**。無論你在寫什麼檔案，這條規則都會載入。            |
| **Apply to Specific Files** | `globs: ["**/*.cs"]` (且 `alwaysApply: false`) | **精準打擊**。只有在編輯符合 `globs` 的檔案時才啟用。         |
| **Apply Intelligently**     | `description: "..."` (且 `alwaysApply: false`) | **智慧載入**。AI 會根據問題與「描述」的相關性來決定是否載入。 |
| **Apply Manually**          | 以上皆否 (或沒觸發時)                          | **被動觸發**。平時不啟用，除非在對話中主動輸入 `@規則名稱`。  |

> AI 的「隱形成本」：
> 當設定為 Always Apply 時，這條規則會佔用 AI 每次對話的 Token (記憶體)。如果規則很多且都設為 Always Apply，AI 處理長代碼的能力會變弱。

最佳「規則套用」配置：

- **全域規範**（如：請用繁體中文回覆、代碼要簡潔）：使用 Always Apply。
- **語言規範**（如：C# 命名慣例、Python 縮排）：使用 Apply to Specific Files (搭配 globs)。這能確保 AI 在寫 Python 時不會被 C# 的規則干擾。
- **特定功能/套件**（如：如何使用特定的 API）：使用 Apply Intelligently。當你沒問到該功能時，AI 的大腦是清空的，效能最好。

## 最佳實務 (Best Practices)

- **保持精簡**：單個規則檔案建議控制在 500 行以內，避免 AI 混淆。
- **具體且可執行**：避免「寫出乾淨的代碼」這種模糊說法，應改為「所有異步方法名稱必須以 Async 結尾」。
- **善用範例**：直接貼上正確的代碼片段，AI 模擬風格的能力會顯著提升。
- **路徑限定**：如果某個規則只針對 frontend/，就將 globs 設窄一點，節省 AI 的 Context 空間。

## 關於 指令 (Command) vs. 規則 (Rule)

在 Cursor 中，這兩者是建構 AI 工作流的兩大支柱：

| 特性         | **指令 (Command)**                                                    | **規則 (Rule / .mdc)**                                                          |
| :----------- | :-------------------------------------------------------------------- | :------------------------------------------------------------------------------ |
| **存放位置** | `.cursor/commands/`                                                   | `.cursor/rules/`                                                                |
| **啟動方式** | **主動觸發**：使用者輸入 `/` 選擇。                                   | **被動感應**：AI 根據檔案或情境自動加載。                                       |
| **核心目的** | **執行特定任務 (SOP)**。例如：產生 PR、進行代碼審查、初始化專案結構。 | **維護持續規範 (Policy)**。例如：強制命名規則、繁體中文回覆、自動同步存檔邏輯。 |
| **適用時機** | 偶發性、階段性的動作。                                                | 持續性、全域性的約束。                                                          |
| **類比**     | **專用工具箱**：需要用到特定工具時才拿出來。                          | **交通法規**：上路後全程自動遵守，不需刻意啟動。                                |

### 搭配建議

- **使用 Rule 守護品質**：定義專案風格與同步邏輯（例如 `planning-archive.mdc`）。
- **使用 Command 提高效率**：定義高頻率重複的動作（例如 `/review`）。
